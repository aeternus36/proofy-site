<!doctype html>
<html lang="sv">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="robots" content="noindex" />
    <title>Proofy – Verifieringsintyg</title>

    <style>
      :root{
        --bg:#070b14;
        --card:#0e1526;
        --border:rgba(255,255,255,.08);
        --text:#eaf0ff;
        --muted:rgba(234,240,255,.72);
        --muted2:rgba(234,240,255,.55);
        --good:#36d399;
        --bad:#ff6b6b;
        --warn:#fbbf24;
        --shadow:0 20px 60px rgba(0,0,0,.35);
        --radius:18px;
        --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      }
      *{box-sizing:border-box}
      body{
        margin:0;
        background: radial-gradient(1200px 600px at 30% 20%, rgba(67,108,255,.20), transparent 60%),
                    radial-gradient(900px 500px at 70% 35%, rgba(54,211,153,.12), transparent 55%),
                    var(--bg);
        color:var(--text);
        font-family:var(--sans);
      }
      a{color:inherit}
      .skip{
        position:absolute; left:-9999px; top:auto;
        width:1px; height:1px; overflow:hidden;
      }
      .skip:focus{
        left:18px; top:18px; width:auto; height:auto;
        padding:10px 12px; border-radius:12px;
        border:1px solid var(--border);
        background:rgba(255,255,255,.08);
        z-index:999;
      }

      header{
        max-width:1100px;
        margin:0 auto;
        padding:22px 18px;
        display:flex;
        align-items:center;
        justify-content:space-between;
        gap:12px;
      }
      .brand{
        display:flex; gap:10px; align-items:center;
        font-weight:800;
        text-decoration:none;
      }
      .logo{
        width:34px;height:34px;border-radius:10px;
        background:linear-gradient(135deg, rgba(67,108,255,.9), rgba(54,211,153,.85));
        box-shadow:0 10px 25px rgba(0,0,0,.25);
      }
      nav{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end}
      .navbtn{
        padding:10px 14px;
        border:1px solid var(--border);
        border-radius:999px;
        background:rgba(255,255,255,.04);
        text-decoration:none;
        font-weight:700;
        color:var(--text);
        transition:.15s ease;
        white-space:nowrap;
      }
      .navbtn:hover{transform:translateY(-1px); background:rgba(255,255,255,.06)}
      .navbtn.primary{background:linear-gradient(135deg, rgba(67,108,255,.95), rgba(54,211,153,.85)); border:0}

      main{
        max-width:1100px;
        margin:0 auto;
        padding:10px 18px 48px;
      }

      .pill{
        display:inline-flex; align-items:center; gap:10px;
        padding:8px 12px;
        border:1px solid var(--border);
        border-radius:999px;
        background:rgba(255,255,255,.04);
        color:var(--muted);
        font-weight:700;
        font-size:13px;
      }

      .hero{
        margin-top:10px;
        border:1px solid var(--border);
        background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
        border-radius:var(--radius);
        box-shadow:var(--shadow);
        padding:26px;
      }
      .heroTop{
        display:flex;
        gap:16px;
        align-items:flex-start;
        justify-content:space-between;
        flex-wrap:wrap;
      }
      h1{
        margin:12px 0 8px;
        font-size:44px;
        letter-spacing:-.02em;
        line-height:1.02;
      }
      .lead{
        max-width:860px;
        color:var(--muted);
        line-height:1.55;
        font-size:16px;
      }
      .statusBadge{
        display:inline-flex; align-items:center; gap:8px;
        padding:10px 14px;
        border-radius:999px;
        font-weight:900;
        border:1px solid var(--border);
        background:rgba(255,255,255,.05);
        min-width:210px;
        justify-content:center;
      }
      .dot{width:9px;height:9px;border-radius:99px;background:var(--warn)}
      .statusBadge.good .dot{background:var(--good)}
      .statusBadge.bad .dot{background:var(--bad)}
      .statusBadge.warn .dot{background:var(--warn)}

      .actions{
        display:flex; gap:10px; flex-wrap:wrap;
        margin-top:16px;
      }
      button{
        appearance:none;
        border:1px solid var(--border);
        background:rgba(255,255,255,.04);
        color:var(--text);
        padding:12px 16px;
        border-radius:999px;
        font-weight:900;
        cursor:pointer;
        transition:.15s ease;
      }
      button:hover{transform:translateY(-1px); background:rgba(255,255,255,.06)}
      button.primary{
        background:linear-gradient(135deg, rgba(67,108,255,.95), rgba(54,211,153,.85));
        border:0;
      }
      button.ghost{background:transparent}
      button:disabled{opacity:.55; cursor:not-allowed; transform:none}

      .grid{
        margin-top:18px;
        display:grid;
        grid-template-columns: 1.15fr .85fr;
        gap:14px;
      }
      @media (max-width: 900px){
        .grid{grid-template-columns:1fr}
        h1{font-size:36px}
      }

      .card{
        border:1px solid var(--border);
        background:rgba(255,255,255,.03);
        border-radius:var(--radius);
        padding:18px;
      }
      .card h3{
        margin:2px 0 10px;
        font-size:13px;
        color:var(--muted2);
        letter-spacing:.08em;
        text-transform:uppercase;
      }
      .kv{
        display:grid;
        grid-template-columns: 1fr 1fr;
        gap:12px;
      }
      @media (max-width: 700px){
        .kv{grid-template-columns:1fr}
      }

      .val{
        background:rgba(0,0,0,.18);
        border:1px solid var(--border);
        border-radius:14px;
        padding:12px;
        min-height:54px;
      }
      .label{
        font-size:12px;
        color:var(--muted2);
        margin-bottom:6px;
        font-weight:800;
      }
      .mono{
        font-family:var(--mono);
        font-size:13px;
        word-break:break-all;
        color:rgba(234,240,255,.92);
      }

      .row{
        display:flex; align-items:center; justify-content:space-between; gap:10px;
      }
      .copyBtn{
        padding:8px 10px;
        font-weight:900;
        border-radius:12px;
        white-space:nowrap;
      }

      .note{
        margin-top:12px;
        color:var(--muted);
        font-size:14px;
        line-height:1.55;
      }

      .fine{
        margin-top:14px;
        border-top:1px solid var(--border);
        padding-top:14px;
        color:var(--muted2);
        font-size:13px;
        line-height:1.6;
      }

      .qrWrap{
        display:flex; align-items:flex-start; gap:14px; flex-wrap:wrap;
      }
      #qrcodeTap{
        width:184px; height:184px;
        border-radius:16px;
        border:1px solid var(--border);
        background:#ffffff;
        display:grid; place-items:center;
        overflow:hidden;
        cursor:pointer;
      }
      #qrcode{
        width:168px; height:168px;
        display:grid; place-items:center;
      }
      #qrcode canvas, #qrcode img, #qrcode svg{
        width:168px !important;
        height:168px !important;
        display:block;
        image-rendering: pixelated;
      }
      .small{
        font-size:12px; color:var(--muted2); line-height:1.45;
        max-width:420px;
      }

      .warnBox{
        margin-top:12px;
        border:1px solid rgba(251,191,36,.35);
        background:rgba(251,191,36,.08);
        border-radius:16px;
        padding:12px;
        color:rgba(255,255,255,.92);
        display:none;
      }
      .warnBox.show{display:block}
      .mutedLink{color:rgba(234,240,255,.88)}
      .footer{
        margin-top:14px;
        color:var(--muted2);
        font-size:12.5px;
        line-height:1.55;
      }

      .txBox{
        margin-top:10px;
        border:1px solid rgba(67,108,255,.25);
        background:rgba(67,108,255,.08);
        border-radius:16px;
        padding:12px;
        display:none;
      }
      .txBox.show{display:block}
      .txTitle{font-weight:900; margin-bottom:6px}
      .txHint{color:rgba(234,240,255,.78); font-size:13px; line-height:1.5}

      @media print{
        header, .actions, #warnBox, #txBox { display:none !important; }
        body{ background:#fff !important; color:#000 !important; }
        .hero, .card { box-shadow:none !important; border-color:#ddd !important; background:#fff !important; }
        .pill, .statusBadge, .val { border-color:#ddd !important; background:#fff !important; }
        .lead, .note, .fine, .small, .footer, .txHint { color:#111 !important; }
        a{ color:#000 !important; text-decoration:none !important; }
      }
    </style>

    <!-- Lokal QR-lib (om den finns). Filen kan saknas eller exportera annat globalt => vi har robust fallback i JS. -->
    <script src="/assets/qr.min.js?v=2026-01-03a"></script>
  </head>

  <body>
    <a class="skip" href="#main">Hoppa till innehåll</a>

    <header>
      <a class="brand" href="/" aria-label="Proofy hem">
        <div class="logo" aria-hidden="true"></div>
        <div>Proofy</div>
      </a>
      <nav aria-label="Navigering">
        <a class="navbtn" href="/pilot">Starta pilot</a>
        <a class="navbtn" href="/verify">Verifiera underlag</a>
        <a class="navbtn" href="/register">Skapa Verifierings-ID</a>
        <a class="navbtn primary" href="/#kontakt">Boka kort demo</a>
      </nav>
    </header>

    <main id="main">
      <div class="pill">Intyg · spårbarhet · byrå &amp; granskning</div>

      <section class="hero" aria-label="Verifieringsintyg">
        <div class="heroTop">
          <div>
            <h1>Verifieringsintyg</h1>
            <div class="lead">
              Detta intyg är ett <b>tekniskt underlag</b> som sammanfattar utfallet av en kontroll av ett
              <b>Verifierings-ID</b> (kontrollvärde kopplat till en specifik filversion) mot Proofys register
              vid angiven kontrolltid. Proofy lagrar <b>inte</b> dokumentinnehåll i registret.
            </div>
          </div>

          <div id="statusBadge" class="statusBadge warn" title="Status för verifiering">
            <span class="dot" aria-hidden="true"></span>
            <span id="statusText">Kontrollerar…</span>
          </div>
        </div>

        <div class="actions">
          <button class="primary" id="btnPrint" type="button">Skriv ut / Spara som PDF</button>
          <button id="btnRefresh" type="button">Uppdatera</button>
          <button class="ghost" id="btnOpenVerify" type="button">Öppna verifiering</button>
        </div>

        <div id="warnBox" class="warnBox" role="status" aria-live="polite" aria-atomic="true"></div>

        <div id="txBox" class="txBox" role="status" aria-live="polite" aria-atomic="true">
          <div class="txTitle">Registrering pågår</div>
          <div class="txHint" id="txHint">—</div>
        </div>

        <div class="grid">
          <div class="card">
            <h3>Sammanfattning</h3>
            <div class="kv">
              <div class="val">
                <div class="label">Verifierings-ID</div>
                <div class="row">
                  <div class="mono" id="hashText">—</div>
                  <button class="copyBtn" id="copyHash" type="button">Kopiera</button>
                </div>
                <div class="small" style="margin-top:8px">
                  ID:t avser en specifik filversion. Ny export/omskanning/omkomprimering kan ge nytt ID även om underlaget ser likadant ut.
                </div>
              </div>

              <div class="val">
                <div class="label">Kontroll genomförd</div>
                <div class="mono" id="checkedLocal">—</div>
                <div class="mono" id="checkedUtc" style="margin-top:6px;color:rgba(234,240,255,.72)">—</div>
                <div class="small" style="margin-top:8px">
                  Kontrolltiden avser <b>när detta intyg uppdaterades</b> (snapshot). Uppdatera vid behov.
                </div>
              </div>

              <div class="val">
                <div class="label">Resultat</div>
                <div class="mono" id="resultText">—</div>
              </div>

              <div class="val">
                <div class="label">Registreringstid hos Proofy</div>
                <div class="mono" id="regLocal">—</div>
                <div class="mono" id="regUtc" style="margin-top:6px;color:rgba(234,240,255,.72)">—</div>
              </div>
            </div>

            <div class="fine">
              <b>Revisions-/juridisk tydlighet (svensk praxis)</b><br/>
              • Intyget visar endast om angivet kontrollvärde (Verifierings-ID) återfinns i Proofys register och i så fall <b>registreringstid</b>.<br/>
              • Registreringstid anger <b>när kontrollvärdet registrerades</b> – inte när dokumentet skapades, signerades, godkändes eller kommunicerades.<br/>
              • Intyget är <b>inte</b> e-signering, <b>inte</b> arkivering, och ersätter <b>inte</b> behörighetsloggar, processkontroller eller juridisk rådgivning.<br/>
              • Bevisvärde bedöms i sitt sammanhang (process, åtkomst, versionshantering, dokumentationskedja och kompletterande kontroller).
            </div>

            <div class="footer">
              <div><b>Integritet:</b> Verifierings-ID skapas lokalt från filen. Vid kontroll skickas endast kontrollvärdet (hash) – inte filen.</div>
              <div style="margin-top:6px">
                <b>Avgifter:</b> Om registrering görs via Proofys servernyckel kan nätverksavgift betalas av Proofy (ingen Metamask-debitering).
              </div>
              <div style="margin-top:6px">Kontakt: <a href="mailto:kontakt@proofy.se">kontakt@proofy.se</a></div>
            </div>
          </div>

          <div class="card">
            <h3>Länkar &amp; QR</h3>
            <div class="qrWrap">
              <div>
                <div class="label" style="margin-bottom:8px">QR-kod (snabb kontroll)</div>
                <div id="qrcodeTap" role="button" tabindex="0" aria-label="QR-kod (klicka för att kopiera verifieringslänk)" title="Klicka för att kopiera verifieringslänk">
                  <div id="qrcode" aria-label="QR-kod"></div>
                </div>
                <div class="small" style="margin-top:10px">
                  Skanna med <b>annan enhet</b> för snabb kontroll. Klick på QR kopierar verifieringslänken.
                </div>
              </div>

              <div style="flex:1; min-width:260px;">
                <div class="val" style="margin-bottom:12px">
                  <div class="label">Länk till intyg</div>
                  <div class="row">
                    <div class="mono" id="certLink">—</div>
                    <button class="copyBtn" id="copyCert" type="button">Kopiera</button>
                  </div>
                </div>

                <div class="val">
                  <div class="label">Verifieringslänk</div>
                  <div class="row">
                    <div class="mono" id="verifyLink">—</div>
                    <button class="copyBtn" id="copyVerify" type="button">Kopiera</button>
                  </div>
                </div>

                <div class="note">
                  <b>Praktiskt tips:</b> Spara Verifierings-ID + intygslänk i ärendet vid fastställande.
                  Dela verifieringslänk/QR vid intern kvalitetskontroll eller efterhandsgranskning.
                </div>

                <div class="small" id="techHint" style="margin-top:10px"></div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <script>
      // ---------- Helpers ----------
      const $ = (id) => document.getElementById(id);

      function isValidBytes32Hex(s){
        return typeof s === "string" && /^0x[0-9a-fA-F]{64}$/.test(s.trim());
      }
      function isValidTxHex(s){
        return typeof s === "string" && /^0x[0-9a-fA-F]{64}$/.test(s.trim());
      }

      function nowSeconds(){ return Math.floor(Date.now()/1000); }

      function fmtUtc(sec){
        if(!sec) return "—";
        const iso = new Date(sec*1000).toISOString(); // 2026-01-08T13:04:41.000Z
        return iso.replace(".000Z","Z").replace("T"," ") + " (UTC)";
      }

      function fmtSe(sec){
        if(!sec) return "—";
        try{
          const dt = new Date(sec*1000);
          const s = new Intl.DateTimeFormat("sv-SE", {
            timeZone:"Europe/Stockholm",
            year:"numeric", month:"2-digit", day:"2-digit",
            hour:"2-digit", minute:"2-digit", second:"2-digit"
          }).format(dt);
          return s + " (Europe/Stockholm)";
        }catch{
          return new Date(sec*1000).toLocaleString("sv-SE") + " (lokal tid)";
        }
      }

      function setStatus(type, text){
        const badge = $("statusBadge");
        badge.classList.remove("good","bad","warn");
        badge.classList.add(type);
        $("statusText").textContent = text;
      }

      function showWarn(html){
        const box = $("warnBox");
        box.innerHTML = html;
        box.classList.add("show");
      }
      function hideWarn(){
        const box = $("warnBox");
        box.innerHTML = "";
        box.classList.remove("show");
      }

      function showTx(html){
        const box = $("txBox");
        $("txHint").innerHTML = html;
        box.classList.add("show");
      }
      function hideTx(){
        const box = $("txBox");
        $("txHint").innerHTML = "—";
        box.classList.remove("show");
      }

      async function copyText(text){
        const t = String(text || "").trim();
        if(!t || t === "—") return;
        try{
          await navigator.clipboard.writeText(t);
        }catch{
          const ta = document.createElement("textarea");
          ta.value = t;
          ta.style.position="fixed";
          ta.style.left="-9999px";
          document.body.appendChild(ta);
          ta.select();
          document.execCommand("copy");
          document.body.removeChild(ta);
        }
      }

      function renderQR(text){
        const el = $("qrcode");
        el.innerHTML = "";

        // Always show something (avoid blank white box).
        const fallback = () => {
          el.innerHTML =
            '<div style="font: 700 12px/1.35 ui-sans-serif,system-ui; color:#0b1220; padding:10px; text-align:center;">' +
            'QR kunde inte renderas.<br/><span style="font-weight:900;">Klicka rutan</span> för att kopiera länken.' +
            "</div>";
        };

        try{
          // Common global for many QR libs
          if (typeof window.QRCode === "function"){
            new window.QRCode(el, {
              text,
              width: 168,
              height: 168,
              colorDark: "#0b1220",
              colorLight: "#ffffff",
              correctLevel: (window.QRCode?.CorrectLevel?.H ?? undefined)
            });
            // Some libs render async; keep fallback if still empty after a tick
            setTimeout(() => { if (!el.firstChild) fallback(); }, 0);
            return;
          }

          // If your /assets/qr.min.js exposes another global, add it here.
          // Example (optional):
          // if (window.qr && typeof window.qr.create === "function") { ... }

          fallback();
        }catch(e){
          fallback();
        }
      }

      async function fetchJson(url, options){
        const r = await fetch(url, { cache:"no-store", ...(options||{}) });
        const data = await r.json().catch(() => ({}));
        if(!r.ok) throw new Error(data?.error || data?.detail || `HTTP ${r.status}`);
        return data;
      }

      function parseVerifyResponse(v){
        // Robust: stöd flera backend-format
        const exists =
          v?.exists === true ||
          v?.registered === true ||
          v?.found === true ||
          v?.match === true;

        const tsRaw = v?.timestamp ?? v?.ts ?? v?.registeredAt ?? v?.registered_at ?? 0;
        const ts = Number(tsRaw) || 0;

        // Om exists saknas men timestamp finns, tolka som registrerad
        const isRegistered = exists || ts > 0;

        return { isRegistered, ts };
      }

      function storageKeyForHash(hash){
        return `proofy:lastTx:${hash}`;
      }

      function polygonscanTxUrl(tx){
        // Amoy
        return `https://amoy.polygonscan.com/tx/${tx}`;
      }

      // ---------- Main ----------
      async function run(){
        hideWarn();
        hideTx();

        const url = new URL(location.href);
        const hash = (url.searchParams.get("hash") || "").trim();

        const checkedParam = (url.searchParams.get("checked") || "").trim();
        const checked = (() => {
          const n = Number(checkedParam);
          return Number.isFinite(n) && n > 0 ? Math.floor(n) : nowSeconds();
        })();

        // Optional: txHash in URL (certificate can display "pending" with explorer link)
        const txParam = (url.searchParams.get("tx") || url.searchParams.get("txHash") || "").trim();

        // Build links: match your deployed routes
        const certId = (url.searchParams.get("cert") || "").trim();

        const certPath = location.pathname; // typically /certificate
        const certLink =
          `${location.origin}${certPath}?hash=${encodeURIComponent(hash)}&checked=${checked}` +
          (certId ? `&cert=${encodeURIComponent(certId)}` : "") +
          (isValidTxHex(txParam) ? `&tx=${encodeURIComponent(txParam)}` : "");

        const verifyLink = `${location.origin}/verify?hash=${encodeURIComponent(hash)}`;

        $("certLink").textContent = certLink;
        $("verifyLink").textContent = verifyLink;

        $("btnOpenVerify").onclick = () => location.href = verifyLink;
        $("btnPrint").onclick = () => window.print();
        $("btnRefresh").onclick = () => run();

        $("copyHash").onclick = () => copyText(hash);
        $("copyCert").onclick = () => copyText(certLink);
        $("copyVerify").onclick = () => copyText(verifyLink);

        // QR leads to verifyLink
        renderQR(verifyLink);

        // QR click copies verifyLink
        const qrTap = $("qrcodeTap");
        const doQrCopy = async () => {
          await copyText(verifyLink);
          showWarn(`<b>Kopierat:</b> verifieringslänk till urklipp.`);
          setTimeout(() => hideWarn(), 1200);
        };
        qrTap.onclick = (e) => { e.preventDefault(); doQrCopy(); };
        qrTap.onkeydown = (e) => {
          if (e.key === "Enter" || e.key === " ") { e.preventDefault(); doQrCopy(); }
        };

        // Times
        $("checkedLocal").textContent = fmtSe(checked);
        $("checkedUtc").textContent = fmtUtc(checked);

        // Validate hash
        if (!isValidBytes32Hex(hash)){
          setStatus("bad", "Ogiltigt ID");
          $("hashText").textContent = "Ogiltigt eller saknas (hash=...)";
          $("resultText").textContent = "Kunde inte verifiera: saknat/ogiltigt Verifierings-ID i URL.";
          $("regLocal").textContent = "—";
          $("regUtc").textContent = "—";
          showWarn(`
            <b>Fel:</b> Intyget saknar giltigt <span class="mono">hash</span> i URL.<br/>
            Exempel: <span class="mono">/certificate?hash=0x...</span>
          `);
          return;
        }

        $("hashText").textContent = hash;

        // Persist tx if provided
        if (isValidTxHex(txParam)){
          try{ localStorage.setItem(storageKeyForHash(hash), txParam); }catch{}
        }

        setStatus("warn", "Kontrollerar…");
        $("resultText").textContent = "Kontrollerar mot Proofys register…";
        $("regLocal").textContent = "—";
        $("regUtc").textContent = "—";
        $("techHint").textContent = "";

        // Verify
        let v;
        try{
          v = await fetchJson(`/api/verify?hash=${encodeURIComponent(hash)}`);
        }catch(e){
          setStatus("bad", "Tillfälligt fel");
          $("resultText").textContent = "Kunde inte kontrollera just nu (tillfälligt fel).";
          showWarn(`
            <b>Tillfälligt fel:</b> kontrollen kunde inte genomföras.<br/>
            Försök igen eller öppna verifieringssidan: <a class="mutedLink" href="${verifyLink}">${verifyLink}</a>
          `);
          return;
        }

        const parsed = parseVerifyResponse(v);

        if (parsed.isRegistered){
          setStatus("good", "Registrerad");
          $("resultText").textContent = "Registrerad (match i Proofys register).";
          $("regLocal").textContent = fmtSe(parsed.ts);
          $("regUtc").textContent = fmtUtc(parsed.ts);

          if (certId){
            $("techHint").innerHTML = `Referens-ID för intyget: <span class="mono">${certId}</span>`;
          }
          hideTx();
          return;
        }

        // Not registered: show stronger, audit-friendly explanation + pending if tx exists
        setStatus("bad", "Ej registrerad");
        $("resultText").textContent = "Inte registrerad (ingen registrering hittades vid kontrolltillfället).";
        $("regLocal").textContent = "—";
        $("regUtc").textContent = "—";

        const storedTx = (() => {
          try{ return localStorage.getItem(storageKeyForHash(hash)) || ""; }catch{ return ""; }
        })();

        const tx = isValidTxHex(txParam) ? txParam : (isValidTxHex(storedTx) ? storedTx : "");

        if (tx){
          // Pending mode: not confirmed yet
          setStatus("warn", "Registrering pågår");
          showTx(`
            Transaktion har skickats men är ännu inte bekräftad i registret.<br/>
            <span class="mono">${tx}</span><br/>
            <a class="mutedLink" href="${polygonscanTxUrl(tx)}" target="_blank" rel="noopener">Öppna på Amoy Polygonscan</a><br/>
            <span style="display:inline-block;margin-top:6px">
              Uppdatera intyget efter att transaktionen är minad. Tills dess kan utfallet vara “Ej registrerad”.
            </span>
          `);
          showWarn(`
            <b>Observera:</b> “Ej registrerad” kan vara korrekt tills registreringen är bekräftad on-chain.<br/>
            Uppdatera intyget för nytt snapshot när transaktionen är bekräftad.
          `);
        } else {
          showWarn(`
            <b>Ingen registrering hittades.</b><br/>
            Kontrollera att rätt filversion/Verifierings-ID används. Om registrering gjordes nyligen: vänta en stund och uppdatera intyget.<br/>
            <span style="display:inline-block;margin-top:6px">
              Tips: om du har en transaktionshash kan du lägga till <span class="mono">&amp;tx=0x...</span> i URL:en för pending-läge.
            </span>
          `);
        }
      }

      run();
    </script>
  </body>
</html>
